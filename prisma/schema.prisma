generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Conversation {
  id            String    @id @default(uuid())
  shopDomain    String
  startedAt     DateTime  @default(now())
  customerEmail String?
  Message       Message[]

  @@index([shopDomain])
}

model Message {
  id             String       @id @default(uuid())
  conversationId String
  timestamp      DateTime     @default(now())
  senderId       Int
  text           String
  senderType     String
  unanswered     Boolean      @default(false)
  Conversation   Conversation @relation(fields: [conversationId], references: [id])

  @@index([conversationId])
}

model User {
  id             Int                   @id @default(autoincrement())
  email          String                @unique
  lastLoginAt    DateTime?
  password       String
  plan           Int                   @default(0)
  customizations ChatbotCustomization?
}

model ChatbotCustomization {
  selectedColor          String
  botName                String
  greetingMessage        String
  fontFamily             String
  fontColor              String
  widgetPosition         String
  toneAndStyle           String
  userGuidance           String
  positiveReinforcement  String
  errorHandling          String
  politeness             String
  clarityAndSimplicity   String
  personalization        String
  responseLength         String
  clarificationPrompt    String
  apologyAndRetryAttempt String
  errorMessageStyle      String
  logo                   String?
  createdAt              DateTime @default(now())
  updatedAt              DateTime @updatedAt
  userEmail              String   @id
  user                   User     @relation(fields: [userEmail], references: [email])
}

model conversation_dist {
  shopDomain String @id
  Monday     Int    @default(0)
  Tuesday    Int    @default(0)
  Wednesday  Int    @default(0)
  Thursday   Int    @default(0)
  Friday     Int    @default(0)
  Saturday   Int    @default(0)
  Sunday     Int    @default(0)
}

model feature_request {
  id          Int    @id @default(autoincrement())
  shop        String
  description String
  details     String
  category    String
}

model shopify_installed_shop {
  id          Int    @id @default(autoincrement())
  shop        String @unique
  accessToken String
  email       String @unique
}

model userDetails {
  id              Int      @id @default(autoincrement())
  shopify_website String
  name            String
  jobRole         String
  interaction     String[]
  industry        String
  companySize     String
  inquiries       String
  Setup           String
  currentTool     String
  learnAbout      String
  email           String
}

model Customer {
  id         Int     @id @default(autoincrement())
  shopDomain String
  firstName  String
  lastName   String
  email      String
  deleted    Boolean @default(false)

  @@unique([shopDomain, email])
}
